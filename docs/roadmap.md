# 開発ロードマップ (Detailed Roadmap)

ファイル作成・実装レベルまで分解した詳細ロードマップです。

## Phase 1: MVP Core (Local-First)
「オフラインでサクサク使える」体験を最優先で実装します。

### 1-1. プロジェクト基盤構築 (Setup)
- [x] **Next.js Project Init**
    - `npx create-next-app@latest` (TypeScript, Tailwind, ESLint, App Router)
    - `pnpm install`
- [x] **UI Library Setup**
    - `npx shadcn@latest init` (`components/ui` 生成)
    - `npx shadcn@latest add button dialog input scroll-area checkbox`
- [x] **Testing Setup**
    - `vitest`, `jsdom`, `@testing-library/react` インストール
    - `vitest.config.ts` 作成
- [x] **Global Files**
    - `src/styles/globals.css`: Tailwind directives, color variables
    - `src/lib/utils.ts`: `cn` helper (generated by shadcn)

### 1-2. データ層の実装 (IndexedDB Layer)
- [x] **DB Configuration**
    - `src/lib/types/db.ts`: `Habit`, `Check` の型定義
    - `src/lib/db/index.ts`: `HabitAppDB` extends `Dexie` クラス実装, Schema 定義
- [x] **Feature: Habit (Data)**
    - `src/features/habit/types.ts`: Domain Types
    - `src/features/habit/db.ts`: `addHabit`, `getHabits` 等の Repository 関数
    - `src/features/habit/store.ts`: `useHabitStore` (Zustand)
    - `src/features/habit/hooks/useHabit.test.ts`: Store/DB 連携の Unit Test
- [x] **Feature: Check (Data)**
    - `src/features/record/types.ts`: Domain Types
    - `src/features/record/db.ts`: `toggleCheck`, `getChecksByMonth`, `addNote`
    - `src/features/record/store.ts`: `useRecordStore` (Zustand)

### 1-3. コア UI 実装 (P0 Requirements)
- [x] **Layout Components**
    - `src/app/layout.tsx`: Root Layout
    - `src/components/layout/Header.tsx`: 年月表示, 設定ボタン
- [x] **Feature: Habit Components**
    - `src/features/habit/components/HabitHeader.tsx`: 習慣アイコン列ヘッダー (Sticky)
    - `src/features/habit/components/HabitForm.tsx`: 習慣追加/編集用フォームコンポーネント
    - `src/features/habit/components/HabitDialog.tsx`: モーダルラッパー
- [x] **Feature: Calendar/Record Components**
    - `src/features/calendar/hooks/useCalendar.ts`: 月の日付配列生成ロジック
    - `src/features/record/components/CheckCell.tsx`: 1マスのチェックボタン (Animation含む)
    - `src/features/record/components/NoteDialog.tsx`: 長押し時のメモ編集モーダル
    - `src/features/calendar/components/DateRow.tsx`: 1日分の行 (日付 + CheckCellの横並び)
- [x] **Main Page Integration**
    - `src/app/page.tsx`: 全体の組み立て (Header + ScrollArea + DateRows + FAB)

### 1-4. 永続化・オフライン検証 (Verification)
- [x] **PWA Configuration**
    - `npm install next-pwa`
    - `next.config.mjs`: PWA plugin 追加
    - `src/app/manifest.ts`: Manifest 生成
- [x] **E2E Testing**
    - `e2e/persistence.spec.ts`: リロード後のデータ保持、オフライン動作テスト
- [ ] **Manual Check**
    - iOS/Android 実機でのホーム画面追加と動作確認

---

## Phase 2: Polish & Release Candidate (P1)
UX向上と公開準備。

### 2-1. UI/UX 改善
- [x] **Micro Interactions**
    - `src/features/record/components/CheckCell.tsx`: Framer Motion アニメーション調整
- [ ] **Date Navigation**
    - `src/features/calendar/components/MonthNavigator.tsx`: 月切り替えボタン実装
- [ ] **Feedback**
    - `src/lib/hooks/useHaptic.ts`: Web Vibration API wrapper

### 2-2. 設定・データ管理
- [ ] **Settings Page**
    - `src/app/settings/page.tsx`: 設定画面レイアウト
    - `src/features/settings/components/DataManagement.tsx`: エクスポート/リセット機能

### 2-3. リリース準備
- [ ] **Assets**
    - `public/icons/`: アプリアイコン配置
- [ ] **Metadata**
    - `src/app/layout.tsx`: Title, Description, OGP

---

## Phase 3: Monetization & Cloud (Future)
バックエンド連携（今回はファイル作成対象外）。

- [ ] **Auth**: Supabase Auth
- [ ] **Sync**: Dexie Cloud or Custom Sync Logic
- [ ] **Billing**: Stripe Integration
